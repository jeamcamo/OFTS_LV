# Thorlabs OSA200/300 LabVIEW Drivers 0.0.2
## Beta version 0.0.2 support
* Tested only on a 64 bit Windows 10 platform.
* Does not support a vip-file installation.
* The executable for the example vi has not been fully tested.
* Please report any malfunctions or bugs through Github, (we will only take into consideration issues that affect the functionality, not program design structure etc).
## Installation package or ZIP-file
The drivers are available as a vi package or a zipped project. The vi package, (vip-file), created with VI Package Manager, will install the OSA FTS drivers in the Labview environment for driver access through an Instrument I/O and Instrument Driver diagram palette. The vi package installation will also enable access to the driver project file, help files and example vis from the Labview Help menu. 

_Please make sure the [OSA GUI application](https://www.thorlabs.com/software_pages/ViewSoftwarePage.cfm?Code=Redstone) has been installed before installing or using the Labview drivers! See the Labview 32/64w bit versions section below for required settings during the application installation._

To have access to the OSA diagram palette (when not installing with a vip-file) proceed as follows:
* download the git-hub latest release asset zip-file
* move the driver hierarchi to the labview instr.lib folder, (example LabVIEW 2010 - C:\Program Files\National Instruments\LabVIEW 2010\instr.lib).
* rename the driver root folder to _Thorlabs OSA FTS_, (path ..\instr.lib\Thorlabs OSA FTS\Thorlabs FTS.lvproj)
* do a mass compile of the driver hierarchi if using a newer version than LabVIEW 2010.

## FTSLib.dll
The driver vis are based on functions in FTSLib.dll version 3.10 or newer, located under Thorlabs OSA in the OSA GUI application installation directory, (Program Files\..). The OSA GUI application installation updates the Path system environment variable with the FTSLib.dll path. 
For detailed information of FTSLib.dll functions; see Thorlabs OSA\lib\FTSLib.docx and the include h-files, available from the Labview Help menu after vip package installation, and located in Thorlabs OSA\lib and \include folders.
Labview 32/64 bit versions
The driver, created in 64bit Labview 2010, must be mass compiled if using a 32 bit Labview version or a Labview version newer than 2010. When installed from the vip installation package; the drivers will be automatically mass compiled by the installed Labview version, or if several versions of Labview are installed; the target Labview version can be selected in the installation wizard. 32 bit Labview requires 32-bit FTSLib.dll - select 32-bit Compatibility while installing the OSA GUI application, (64 bit OS). Also, with 32 bit Labview and 64 bit OS; the Path system environment variable must contain the 32bit Thorlabs OSA GUI application installation path, Program (x86)\.., and not the 64bit ditto, see Installation package above. 
# Driver vis
See the TREE vis for a categorized overview of the driver vis and the example vis for guidelines of how to use them. For most applications the FTSLib.dll functions supported by the Labview drivers will be appropriate; however some functions have not yet been implemented. When adding new vis that call functions in FTSLib.dll we recommend the Labview import shared library tool.  
# Example vis
A simple example shows the basic spectrum retrival and buffering procedure, and a more complex how to retrieve both interferogram and spectrum with some post dataprocessing. There are also examples for setting data-acquisition options, instrument properties and interferogram/spectrum analysis. A traces example shows how to make use of data buffers allocated by FTSLib.dll.
# Support Files
FTSLV.dll was created for Labview calls to FTSLib functions requiring function pointer parameters. Addresses to functions within FTSLV.dll are fetched via kernel32.dll and serve as input parameter values to data acquisition functions in FTSLib.dll. 

FTSLib.lvlib contains some Labview autogenerated FTSLib.dll wrappers used in some of the driver vis, (most of the vis calling FTSLib.dll functions don’t have wrappers).

_goop4.llb contains vis supporting the main OSA class.
# Building Executables
See the Thorlabs FTS project build specification for the OSA_Example.vi, (regarding support files). 
The path to FTSLib.dll and FTSLV.dll must be set in the PATH system environment variable, (updated during OSA GUI application installation). 
# OSA Class
The fact that the driver vis are part of LabVIEW classes does not necessarily require any attention. When adding new driver vis we recommend starting out with existing driver vis as templates to comply with and conveniently access GOOP class/objects properties. 
# Known Issues
Large Data Sets
When acquiring the largest interferogram datasets in conjunction with zero fill and other data analysis functions; see chapter 7, ‘Recommended Hardware and Software Requirements’ in the Thorlabs OSA manuals for the OSA200 or 300/Redstone series. Data-acquisition to traces, instead of the OSA dedicated Labview buffer, will in most cases improve performance/execution time – see the traces example and trace vis in the tree.vi.
 
# Changes Log 
0.0.2
Beta version for OSA200/300 series that supports FTSLib.dll version 3.10 and newer.

